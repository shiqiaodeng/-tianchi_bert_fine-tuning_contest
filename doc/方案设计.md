

# 天池预训练模型泛化能力挑战赛——方案设计



优化方案：

1、增强数据，对数据进行预处理，参考Promot

2、优化模型结构进行微调；

## 1、数据预处理

对原始数据集进行预处理，对emotion数据集去除表情、去重处理、添加标签，对ocnli和tnews添加标签；

### 类图设计

```mermaid
classDiagram
	ABC <|-- DataPreprocessor
	DataPreprocessor <|-- _EmotionDataPreprocessor
	DataPreprocessor <|-- _OcnliDataPreprocessor
	DataPreprocessor <|-- _TnewsDataPreprocessor
	
	class DataPreprocessor {
		- str _data_path
		- dict self._data
		
		+ __init__(self, data_path: str, emotion_path: str = None)
		+ __str__(self)
		+ save_to_csv(self, save_path)
		
		- _process_data(self) # 虚接口
		+ DataPreprocessor create_object(cls, type: DataPreprocessorType, data_path: str, emotion_path: str = None) # 类接口，工厂实现
	}
	class _OcnliDataPreprocessor {
		- _process_data(self)
	}
	class _TnewsDataPreprocessor {
		- _process_data(self)
	}
	class _EmotionDataPreprocessor {
		- self._emotion_path
		- _process_data(self)
		- __clean_emotion(self)
		- __clean_duplication(self)
	}
	
```

**测试用例设计**

| 测试场景        | 输入数据                                                     | 期望输出                                     |
| --------------- | ------------------------------------------------------------ | -------------------------------------------- |
| 处理emotion数据 | OCEMOTION_a.csv<br />OCEMOTION_b.csv<br />OCEMOTION_train1128.csv | 输出处理后的数据文件，去除重复符号和表情符号 |
| 处理OCNLI数据   | OCNLI_a.csv<br />OCNLI_b.csv<br />OCNLI_train1128.csv        | 输出处理后的数据文件，去除重复符号           |
| 处理TNEWS数据   | TNEWS_a.csv<br />TNEWS_b.csv<br />TNEWS_train1128.csv        | 输出处理后的数据文件，去除重复符号           |
|                 |                                                              |                                              |

**测试用例设计**

| 测试场景                  | 输入数据                                           | 期望输出                                                     |
| ------------------------- | -------------------------------------------------- | ------------------------------------------------------------ |
| 向量化预处理后emotion数据 | OCEMOTION_train1128.csv<br />OCEMOTION_a.csv<br /> | 训练集向量化后划分为训练集和验证集，测试集向量化，输出pt文件 |
| 向量化预处理后OCNLI数据   | OCNLI_a.csv<br />OCNLI_train1128.csv               | 训练集向量化后划分为训练集和验证集，测试集向量化，输出pt文件 |
| 向量化预处理后TNEWS数据   | TNEWS_a.csv<br />TNEWS_train1128.csv               | 训练集向量化后划分为训练集和验证集，测试集向量化，输出pt文件 |



## 2、数据向量化

将输入训练数据划分为训练集和验证集，将test_a、test_b数据作为预测数据；

### 类图设计

```mermaid
classDiagram
	class BertMultitaskClassifierDataProc {
		- str task_name
		- str train_data_path
		- str predict_data_path
		- BertTokenizer tokenizer
		- float train_val_split_ratio
		
		- dict dict train_encoding
		- dict val_encoding
		- dict predict_encoding
		- dict label2id

		
		+ __init__(self, task_name: str, train_data_path: str, predict_data_path: str, tokenizer: BertTokenizer, train_val_split_ratio: float = 0.1)
		+ __str__(self)
		+ save(self, save_path)
		
		- __process_train_data(self)
		- __process_predict_data(self)
		- __process_data(self, df)
		- __split_train_val(self, inputs)
		- __encode_labels(self, labels)
	}
```



## 2、BERT多任务微调模型

### 模型架构

![image-20250803093403847](C:\Users\邓石桥\AppData\Roaming\Typora\typora-user-images\image-20250803093403847.png)





















